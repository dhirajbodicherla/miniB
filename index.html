<!DOCTYPE html>
<html>
<head>
    <title></title>
    <style type="text/css">
        .url-bar{
            margin-top: 25px;
        }
        .url-bar .url-input-container{
          position:absolute; 
          height: 30px;
          top: 10px;
          left: 10px;
          right: 60px;

        }
        .url-bar .url-input-container #url{
          position: absolute;
          width: 98%;
          left: 0;
          right: 0px;
          top: 0px;
          bottom: 0px;
          font-size: 15px;
          font-family: Helvetica;
        }
        .url-bar .url-input-container #url:focus{
          outline: none;
        }
        .url-bar .fetch-container{
          position :absolute;
          right: 10px;
          top: 10px;
          height: 30px;
          float: right;
          
        }
        .url-bar #fetch{
          height: 30px;
          border: none;
          color: white;
          background: #666;
        }
        .url-bar #fetch:hover{
          cursor: pointer;
        }
    </style>
</head>
<body style="-webkit-app-region: drag">
    <div class="url-bar">
      <div class="url-input-container">
        <input type="text" id="url" />
      </div>
      <div class="fetch-container">
        <input type="button" id="fetch" value="Fetch"/>
      </div>
    </div>
    <script type="text/javascript">
        var gui = require('nw.gui');
        gui.Screen.Init();
        var screens = gui.Screen.screens;
        win = gui.Window.get();
        var clipboard = gui.Clipboard.get();
        var tray;
        var urlInput = document.getElementById("url");
        var fetchButton = document.getElementById("fetch");
        // var hide = document.getElementById("hide");
        // hide.addEventListener('click', function(){
        //     win.frame = false;
        // });
        win.minimize();
        tray();
        var new_win = gui.Window.open('https://github.com',{
          "toolbar": false,
          "frame": false,
        });
        var new_win2 = gui.Window.open('https://google.com',{
          "toolbar": false,
          "frame": false,
        });
        var item = new gui.MenuItem({
            label: 'Github',
            click: function () {
                new_win.close();
                tray.menu.remove(item);
                // tray.remove();
                // tray = null;
            }
        });
        var item2 = new gui.MenuItem({
            label: 'Google',
            click: function () {
                new_win2.close();
                tray.menu.remove(item2);
                // tray.remove();
                // tray = null;
            }
        });

        tray.menu.append(item);
        tray.menu.append(item2);
        
        // var new_win = gui.Window.get(
        //   window.open('https://github.com')
        // );
        // var new_wi = gui.Window.get(
        //   window.open('https://github.com')
        // );
        setTimeout(function(){
          var top = screens[0].bounds.height - screens[0].work_area.height;
          new_win.resizeTo(Math.floor(screens[0].bounds.width/2),Math.floor(screens[0].work_area.height/2));
          new_win.moveTo(0,top);
        }, 1000);
        fetchButton.addEventListener('click', function(){
            var url = urlInput.value;
            start(url);
        });
        urlInput.addEventListener('keydown', function(e) {
            if (e.which == 86) {
                if (e.metaKey || e.ctrlKey) {
                    urlInput.value = clipboard.get('text');
                } 
            }
        });
        

        function start(url){
            window.location.href = url;
            win.on('minimize', function () {
                this.hide();
                tray();
            });
        }

        function tray() {
            tray = new gui.Tray({
                icon: 'images/trayicon-16x16.png'
            });
            /*
            menu.append(new gui.MenuItem({
                label: 'Show',
                click: function () {
                    win.show();
                    tray.remove();
                    tray = null;
                }
            }));
            menu.append(new gui.MenuItem({
                label: 'Quit',
                click: function () {
                    tray.remove();
                    tray = null;
                    win.close();
                }
            }));
            */
            tray.menu = new gui.Menu();
        }
        
    </script>
</body>
</html>